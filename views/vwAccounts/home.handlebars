{{#section 'css'}}
<style>
    /* --- 1. CSS CHO NAVBAR CHUẨN KHI SCROLL --- */
    /* Để khi click menu, nội dung không bị che bởi navbar sticky */
    html {
        scroll-behavior: smooth;
        scroll-padding-top: 85px;
    }

    /* --- 2. HERO & SECTIONS STYLE --- */
    .hero-section {
        background-color: #eef7f9;
        padding: 80px 0;
        border-bottom-right-radius: 100px;
    }

    .hero-title {
        font-family: 'Abhaya Libre', serif;
        font-size: 3.5rem;
        font-weight: 800;
        color: #222;
    }

    .hero-img {
        max-width: 100%;
        border-radius: 20px;
        box-shadow: 20px 20px 0px rgba(45, 91, 255, 0.1);
    }

    .section-padding {
        padding: 80px 0;
    }

    .section-title {
        font-family: 'Abhaya Libre', serif;
        font-weight: 800;
        font-size: 2.5rem;
        text-align: center;
        margin-bottom: 3rem;
        color: #2d5bff;
    }

    /* --- 3. SERVICES SECTION STYLES --- */
    .services-section {
        background: linear-gradient(135deg, #f8f9fa 0%, #e9ecef 100%);
    }

    .service-card {
        background: white;
        border-radius: 20px;
        padding: 30px;
        text-align: center;
        box-shadow: 0 10px 30px rgba(0, 0, 0, 0.1);
        transition: all 0.3s ease;
        border: none;
        height: 100%;
        overflow: hidden;
        position: relative;
    }

    .service-card::before {
        content: '';
        position: absolute;
        top: 0;
        left: 0;
        right: 0;
        height: 4px;
        background: linear-gradient(90deg, #2d5bff, #17a2b8, #28a745);
        transform: scaleX(0);
        transition: transform 0.3s ease;
    }

    .service-card:hover::before {
        transform: scaleX(1);
    }

    .service-card:hover {
        transform: translateY(-10px);
        box-shadow: 0 20px 40px rgba(45, 91, 255, 0.2);
    }

    .service-icon {
        width: 80px;
        height: 80px;
        margin: 0 auto 20px;
        background: linear-gradient(135deg, #2d5bff 0%, #17a2b8 100%);
        border-radius: 50%;
        display: flex;
        align-items: center;
        justify-content: center;
        font-size: 2.5rem;
        color: white;
        box-shadow: 0 8px 25px rgba(45, 91, 255, 0.3);
        transition: all 0.3s ease;
    }

    .service-card:hover .service-icon {
        transform: scale(1.1);
        background: linear-gradient(135deg, #28a745 0%, #20c997 100%);
        box-shadow: 0 12px 35px rgba(40, 167, 69, 0.4);
    }

    .service-title {
        font-family: 'Abhaya Libre', serif;
        font-size: 1.3rem;
        font-weight: 700;
        color: #2c3e50;
        margin-bottom: 15px;
        text-transform: uppercase;
        letter-spacing: 1px;
    }

    .service-description {
        color: #6c757d;
        font-size: 0.95rem;
        line-height: 1.6;
        margin-bottom: 25px;
    }

    .service-price {
        font-family: 'Abhaya Libre', serif;
        font-size: 1.4rem;
        font-weight: 800;
        color: #2d5bff;
        margin-bottom: 20px;
    }

    .service-btn {
        background: linear-gradient(135deg, #2d5bff 0%, #17a2b8 100%);
        border: none;
        border-radius: 25px;
        padding: 10px 25px;
        color: white;
        font-weight: 600;
        text-transform: uppercase;
        letter-spacing: 1px;
        transition: all 0.3s ease;
        box-shadow: 0 4px 15px rgba(45, 91, 255, 0.3);
    }

    .service-btn:hover {
        background: linear-gradient(135deg, #17a2b8 0%, #2d5bff 100%);
        transform: translateY(-2px);
        box-shadow: 0 8px 25px rgba(45, 91, 255, 0.4);
        color: white;
    }

    @media (max-width: 768px) {
        .service-card {
            margin-bottom: 30px;
        }
        
        .service-icon {
            width: 60px;
            height: 60px;
            font-size: 2rem;
        }
        
        .service-title {
            font-size: 1.1rem;
        }
    }

    /* --- 4. BOOKING MODAL STYLES --- */
    .modal-content-custom {
        border: 4px solid #b1a4a4;
        border-radius: 25px;
        overflow: hidden;
        box-shadow: 0 10px 30px rgba(0, 0, 0, 0.2);
    }

    .modal-header-custom {
        background-color: #d9d9d9;
        border-bottom: 3px solid #b1a4a4;
        padding: 15px;
        position: relative;
        justify-content: center;
    }

    .modal-title-custom {
        font-family: 'Abhaya Libre', serif;
        font-weight: 900;
        font-size: 1.5rem;
        text-transform: uppercase;
        color: #222;
    }

    .btn-close-custom {
        position: absolute;
        right: 20px;
        top: 50%;
        transform: translateY(-50%);
        background: transparent url("data:image/svg+xml,%3csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 16 16' fill='%23a33'%3e%3cpath d='M.293.293a1 1 0 0 1 1.414 0L8 6.586 14.293.293a1 1 0 1 1 1.414 1.414L9.414 8l6.293 6.293a1 1 0 0 1-1.414 1.414L8 9.414l-6.293 6.293a1 1 0 0 1-1.414-1.414L6.586 8 .293 1.707a1 1 0 0 1 0-1.414z'/%3e%3c/svg%3e") center/1em auto no-repeat;
        border: 3px solid #a33;
        border-radius: 50%;
        opacity: 1;
        padding: 0.5rem;
        width: 2.5rem;
        height: 2.5rem;
        cursor: pointer;
    }

    .btn-close-custom:hover {
        opacity: 0.7;
    }

    .custom-input {
        border: 2px solid #000;
        border-radius: 50px;
        padding: 10px 15px;
    }

    /* --- 5. CHECKBOX STYLES --- */
    .form-check {
        margin-bottom: 8px;
        padding: 5px 0;
    }

    .form-check-input {
        border: 2px solid #000;
        cursor: pointer;
        accent-color: #2d5bff;
    }

    .form-check-input:checked {
        background-color: #2d5bff;
        border-color: #2d5bff;
    }

    .form-check-label {
        cursor: pointer;
        margin-left: 8px;
        color: #333;
    }
</style>
{{/section}}

<section id="home" class="hero-section">
    <div class="container">
        <div class="row align-items-center">
            <div class="col-lg-6">
                <h1 class="hero-title mb-4">Professional Pet Care <br>You Can Trust</h1>
                <p class="lead text-secondary mb-4">
                    Expert veterinary services, professional grooming, and comprehensive health care for your beloved pets. 
                    Your furry family members deserve the best care available.
                </p>
                <div class="d-flex gap-3 flex-wrap">
                    <button class="btn btn-primary btn-lg rounded-pill px-5 fw-bold"
                        style="background: linear-gradient(135deg, #2d5bff 0%, #17a2b8 100%); border: none; box-shadow: 0 8px 25px rgba(45, 91, 255, 0.3);" 
                        data-bs-toggle="modal" data-bs-target="#bookingModal">
                        <i class="bi bi-calendar-heart me-2"></i>Book Appointment
                    </button>
                    
                </div>
            </div>
            <div class="col-lg-6 text-center mt-5 mt-lg-0">
                <div class="position-relative">
                    <img src="https://img.freepik.com/free-photo/group-portrait-adorable-puppies_53876-64778.jpg" 
                         alt="Professional Pet Care" class="hero-img">
                    
                    
                </div>
            </div>
        </div>
    </div>
</section>

<section id="about" class="services-section section-padding">
    <div class="container">
        <h2 class="section-title">Our Premium Services</h2>
        <p class="text-center text-secondary mb-5" style="font-size: 1.1rem;">
            Comprehensive pet care services designed to keep your furry friends healthy and happy
        </p>
        
        <div class="row g-4">
            <!-- Veterinary Consultation -->
            <div class="col-lg-4 col-md-6">
                <div class="service-card">
                    <div class="service-icon">
                        <i class="fas fa-stethoscope"></i>
                    </div>
                    <h4 class="service-title">Veterinary Consultation</h4>
                    <p class="service-description">
                        Comprehensive health checkups and medical consultations by our experienced veterinarians to ensure your pet's optimal health.
                    </p>
                    <div class="service-price">From $50</div>
                    <button class="service-btn" data-bs-toggle="modal" data-bs-target="#bookingModal">
                        <i class="bi bi-calendar-plus me-2"></i>Book Now
                    </button>
                </div>
            </div>

            <!-- Pet Grooming -->
            <div class="col-lg-4 col-md-6">
                <div class="service-card">
                    <div class="service-icon">
                        <i class="fas fa-cut"></i>
                    </div>
                    <h4 class="service-title">Professional Grooming</h4>
                    <p class="service-description">
                        Complete grooming services including bathing, nail trimming, hair cutting, and styling to keep your pet looking and feeling great.
                    </p>
                    <div class="service-price">From $35</div>
                    <button class="service-btn" data-bs-toggle="modal" data-bs-target="#bookingModal">
                        <i class="bi bi-calendar-plus me-2"></i>Book Now
                    </button>
                </div>
            </div>

            <!-- Vaccination -->
            <div class="col-lg-4 col-md-6">
                <div class="service-card">
                    <div class="service-icon">
                        <i class="fas fa-syringe"></i>
                    </div>
                    <h4 class="service-title">Vaccination Program</h4>
                    <p class="service-description">
                        Complete vaccination schedules and preventive care to protect your pet from common diseases and maintain their immunity.
                    </p>
                    <div class="service-price">From $25</div>
                    <button class="service-btn" data-bs-toggle="modal" data-bs-target="#bookingModal">
                        <i class="bi bi-calendar-plus me-2"></i>Book Now
                    </button>
                </div>
            </div>

            <!-- Emergency Care -->
            <div class="col-lg-4 col-md-6">
                <div class="service-card">
                    <div class="service-icon">
                        <i class="fas fa-ambulance"></i>
                    </div>
                    <h4 class="service-title">Emergency Care</h4>
                    <p class="service-description">
                        24/7 emergency veterinary services for urgent medical situations. Our team is always ready to help in critical moments.
                    </p>
                    <div class="service-price">From $100</div>
                    <button class="service-btn" data-bs-toggle="modal" data-bs-target="#bookingModal">
                        <i class="bi bi-calendar-plus me-2"></i>Book Now
                    </button>
                </div>
            </div>

            <!-- Surgery -->
            <div class="col-lg-4 col-md-6">
                <div class="service-card">
                    <div class="service-icon">
                        <i class="fas fa-user-md"></i>
                    </div>
                    <h4 class="service-title">Surgical Procedures</h4>
                    <p class="service-description">
                        Advanced surgical procedures performed by skilled veterinary surgeons with modern equipment and sterile environments.
                    </p>
                    <div class="service-price">From $200</div>
                    <button class="service-btn" data-bs-toggle="modal" data-bs-target="#bookingModal">
                        <i class="bi bi-calendar-plus me-2"></i>Book Now
                    </button>
                </div>
            </div>

            <!-- Dental Care -->
            <div class="col-lg-4 col-md-6">
                <div class="service-card">
                    <div class="service-icon">
                        <i class="fas fa-tooth"></i>
                    </div>
                    <h4 class="service-title">Dental Care</h4>
                    <p class="service-description">
                        Complete dental health services including cleaning, tooth extraction, and oral health maintenance for optimal pet wellness.
                    </p>
                    <div class="service-price">From $75</div>
                    <button class="service-btn" data-bs-toggle="modal" data-bs-target="#bookingModal">
                        <i class="bi bi-calendar-plus me-2"></i>Book Now
                    </button>
                </div>
            </div>
        </div>
    </div>
</section>

<div class="modal fade" id="bookingModal" tabindex="-1" aria-hidden="true">
    <div class="modal-dialog modal-dialog-centered">
        <div class="modal-content modal-content-custom" style="max-width: 500px; margin: auto;">
            <div class="modal-header modal-header-custom">
                <h5 class="modal-title-custom">BOOKING FORM</h5>
                <button type="button" class="btn-close-custom" data-bs-dismiss="modal" aria-label="Close"></button>
            </div>
            <div class="modal-body p-4">
                <form id="bookingForm" method="POST" action="/account/appointment/book">
                    {{!-- Pet Selection --}}
                    <div class="mb-3">

                        {{#if pets}}
                        <select class="form-select custom-input text-uppercase text-muted fw-bold" name="pet_id"
                            style="border-radius: 50px;" required>
                            <option selected disabled>SELECT YOUR PET</option>
                            {{#each pets}}
                            <option value="{{this.pet_id}}">{{this.name}}</option>
                            {{/each}}
                        </select>
                        {{else}}
                        <div class="alert alert-warning">No pets found. Please add a pet first.</div>
                        {{/if}}

                    </div>

                    {{!-- Date & Time --}}
                    <div class="row mb-3">
                        <div class="col-6">
                            <input type="text" class="form-control custom-input text-uppercase text-muted fw-bold"
                                name="date_start" placeholder="DATE" onfocus="(this.type='date')"
                                onblur="(this.type='text')" style="border-radius: 50px;" required>
                        </div>
                        <div class="col-6">
                            <input type="text" class="form-control custom-input text-uppercase text-muted fw-bold"
                                name="time" placeholder="TIME" onfocus="(this.type='time')" onblur="(this.type='text')"
                                style="border-radius: 50px;" required>
                        </div>
                    </div>

                    {{!-- Services Selection (Multiple) --}}
                    <div class="mb-3">
                        <label class="form-label fw-bold text-uppercase text-muted" style="font-size: 0.9rem;">Select
                            Services:</label>
                        {{#if serviceList}}
                        <div
                            style="border: 2px solid #000; border-radius: 20px; padding: 20px 40px; background-color: #fff; max-height: 150px; overflow-y: auto;">
                            {{#each serviceList}}
                            <div class="form-check">
                                <input class="form-check-input" type="checkbox" name="services"
                                    value="{{this.service_id}}" id="service_{{this.service_id}}">
                                <label class="form-check-label fw-bold" for="service_{{this.service_id}}">
                                    {{this.service_name}}
                                </label>
                            </div>
                            {{/each}}
                        </div>
                        {{else}}
                        <div class="alert alert-warning">No services available.</div>
                        {{/if}}
                    </div>

                    {{!-- Note --}}
                    <div class="mb-4">
                        <textarea class="form-control custom-input text-muted" name="note"
                            placeholder="Note something..." rows="5"
                            style="border-radius: 20px; resize: none;"></textarea>
                    </div>

                    {{!-- Submit Button --}}
                    <div class="text-end">
                        <button type="submit" class="btn btn-outline-primary px-4 py-2 fw-bold"
                            style="border-radius: 10px; border-width: 2px;">SUBMIT</button>
                    </div>
                </form>
            </div>
        </div>
    </div>
</div>

{{#section 'js'}}
<script src="https://cdn.jsdelivr.net/npm/sweetalert2@11"></script>
<script>
    document.addEventListener("DOMContentLoaded", function () {
        // 1. Lấy tất cả các section cần theo dõi
        const sections = document.querySelectorAll("section, footer");
        const navLinks = document.querySelectorAll(".navbar-nav .nav-link");

        // KIỂM TRA QUAN TRỌNG:
        // Chỉ chạy tính năng này nếu trang hiện tại có section #home (tức là trang chủ)
        const homeSection = document.querySelector("#home");

        if (!homeSection) {
            // Nếu không phải trang chủ, xóa class active khỏi tất cả link menu
            navLinks.forEach(link => link.classList.remove("active"));
            return; // Dừng script tại đây
        }

        // Nếu là trang chủ, tiếp tục chạy logic ScrollSpy cũ
        window.addEventListener("scroll", () => {
            let current = "";
            sections.forEach((section) => {
                const sectionTop = section.offsetTop;
                // Tinh chỉnh offset một chút (-150) cho mượt
                if (pageYOffset >= sectionTop - 150) {
                    current = section.getAttribute("id");
                }
            });

            navLinks.forEach((link) => {
                link.classList.remove("active");
                // Kiểm tra nếu link có chứa id của section hiện tại
                if (link.getAttribute("href").includes(current)) {
                    link.classList.add("active");
                }
            });
        });

        // Booking form SweetAlert
        const bookingForm = document.getElementById('bookingForm');
        if (bookingForm) {
            bookingForm.addEventListener('submit', function(e) {
                e.preventDefault();
                Swal.fire({
                    title: 'Success!',
                    text: 'Appointment booked successfully.',
                    icon: 'success',
                    confirmButtonText: 'OK'
                }).then(() => {
                    e.target.submit();
                });
            });
        }
    });
</script>
{{/section}}